<sml:AggregateProcess xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sml="http://www.opengis.net/sensorml/2.0" xmlns:swe="http://www.opengis.net/swe/2.0" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:gco="http://www.isotc211.org/2005/gco" xmlns:gmd="http://www.isotc211.org/2005/gmd" gml:id="CHAIN1">
  <gml:identifier codeSpace="uid">0c58ed65-e63d-4d1e-9ef0-b7db0be3685c</gml:identifier>
  <sml:outputs>
    <sml:OutputList>
      <sml:output name="videoFrame">
        <swe:DataRecord>
          <swe:field name="width">
            <swe:Count id="FRAME_WIDTH" definition="http://sensorml.com/ont/swe/property/GridWidth"/>
          </swe:field>
          <swe:field name="height">
            <swe:Count id="FRAME_HEIGHT" definition="http://sensorml.com/ont/swe/property/GridHeight"/>
          </swe:field>
          <swe:field name="img">
						<swe:DataArray definition="http://sensorml.com/ont/swe/property/VideoFrame">
							<swe:elementCount xlink:href="#FRAME_HEIGHT" />
							<swe:elementType name="row">
								<swe:DataArray>
									<swe:elementCount xlink:href="#FRAME_WIDTH" />
									<swe:elementType name="pixel">
										<swe:DataRecord>
											<swe:field name="red">
												<swe:Count definition="http://sensorml.com/ont/swe/property/RedChannel" />
											</swe:field>
											<swe:field name="green">
												<swe:Count definition="http://sensorml.com/ont/swe/property/GreenChannel" />
											</swe:field>
											<swe:field name="blue">
												<swe:Count definition="http://sensorml.com/ont/swe/property/BlueChannel" />
											</swe:field>
										</swe:DataRecord>
									</swe:elementType>
								</swe:DataArray>
							</swe:elementType>
						</swe:DataArray>
					</swe:field>
        </swe:DataRecord>
      </sml:output>
    </sml:OutputList>
  </sml:outputs>
  <sml:components>
    <sml:ComponentList>
      <sml:component name="source0">
        <sml:SimpleProcess gml:id="P1">
          <gml:identifier codeSpace="uid">urn:osh:sensor:v4l-cam:001</gml:identifier>
          <sml:typeOf xlink:href="urn:osh:process:datasource:stream"/>
          <sml:configuration>
            <sml:Settings>
              <sml:setValue ref="parameters/producerURI">urn:osh:sensor:v4l-cam:001</sml:setValue>
            </sml:Settings>
          </sml:configuration>
        </sml:SimpleProcess>
      </sml:component>
      <sml:component name="decoder">
        <sml:SimpleProcess gml:id="P2">
          <sml:typeOf xlink:href="urn:osh:process:FFMpegDecoder"/>
          <sml:configuration>
            <sml:Settings>
              <sml:setValue ref="inputs/codedFrame/width">640</sml:setValue>
              <sml:setValue ref="inputs/codedFrame/height">480</sml:setValue>
              <sml:setValue ref="parameters/codec">H264</sml:setValue>
            </sml:Settings>
          </sml:configuration>
        </sml:SimpleProcess>
      </sml:component>
      <sml:component name="display">
        <sml:SimpleProcess gml:id="P3">
          <sml:typeOf xlink:href="urn:osh:process:VideoDisplay"/>
        </sml:SimpleProcess>
      </sml:component>
    </sml:ComponentList>
  </sml:components>
  <sml:connections>
    <sml:ConnectionList>
      <sml:connection>
        <sml:Link>
          <sml:source ref="components/source0/outputs/camOutput_H264/img"/>
          <sml:destination ref="components/decoder/inputs/codedFrame/img"/>
        </sml:Link>
      </sml:connection>
      <sml:connection>
        <sml:Link>
          <sml:source ref="components/source0/outputs/camOutput_H264/time"/>
          <sml:destination ref="components/display/inputs/timeStamp"/>
        </sml:Link>
      </sml:connection>
      <sml:connection>
        <sml:Link>
          <sml:source ref="components/decoder/outputs/rgbFrame"/>
          <sml:destination ref="outputs/videoFrame"/>
        </sml:Link>
      </sml:connection>
      <sml:connection>
        <sml:Link>
          <sml:source ref="components/decoder/outputs/rgbFrame"/>
          <sml:destination ref="components/display/inputs/rgbFrame"/>
        </sml:Link>
      </sml:connection>
    </sml:ConnectionList>
  </sml:connections>
</sml:AggregateProcess>